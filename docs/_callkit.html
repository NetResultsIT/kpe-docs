<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.15.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>KPE User Documentation: Callkit</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">KPE User Documentation<span id="projectnumber">&#160;0.1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.15.0 -->
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search',true);
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('_callkit.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">Callkit </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Callkit Title</title>
    
    <style>
        h1.title { text-align: center; }
        h3.description { font-size: 1.2em; font-weight: 500; }
        h3.sub-argument__title {  font-size: 1.5em; font-weight: 600; }
        p.argument { font-size: 2em; font-weight: 800; text-align: center; }
        span.bold { font-weight: 800;}

        section.pause-resuming-call { margin: 10em 0; }

    </style>
</head>
<body>
    <h1 class="title">Kpe Callkit Integration</h1>
    <h3 class="description">In this page will be shown how to integrate iOS callkit with KPE</h3>
    
    <section class="pause-resuming-call">
        <p class="argument">Call handling</p>
        <div class="sub-argument">
            <h3 class="sub-argument__title">Pause/Resuming call</h3>
            <p class="sub-argument__description">
                To better integrate the callkit subsystem of ios, with the pause and resume of the call, 
                the kpe api for managing the pause and resume of the call must be called in certain callbacks that callkit provides us.
            </p>
            <p style="font-weight: 700; font-style: italic;">Pause a call</p>
            <p>If the developer wants to pause a call, before calling the kpe api related to the pause, he must perform the following steps:</p>
            <ul>
                <li>Perform a transaction with action <span class="bold">CXSetHeldCallAction.<span/></li>
                <li>
                    In the <span class="bold">provider(_ provider: CXProvider, perform action: CXSetHeldCallAction) </span>
                    callkit's callback, the kpe api to pause the call <span class="bold">ios_pauseCallOnLine</span> with the line associated to the call should be invoked.
                </li>
                <li>If all voip calls are "holded" then callkit's callback <span class="bold">provider(_ provider: CXProvider, didDeactivate audioSession: AVAudioSession)</span> is invoked
                </li>
                <li>In the callback's body the kpe api <span class="bol">activateAudioSession(isActivate: false)</span>must be invoked</li>
            </ul>
            <p>Below the sequence diagram</p>
            <img src="callkit-pause_call.png" width="80%"/>

            <p style="font-weight: 700; font-style: italic;">Resuming a call</p>
            <p>If the developer wants to resuming a call, before calling the kpe api related to the pause, he must perform the following steps:</p>
            <ul>
                <li>Perform a transaction with action <span class="bold">CXSetHeldCallAction.<span/></li>
                <li>
                    In the <span class="bold">provider(_ provider: CXProvider, perform action: CXSetHeldCallAction) </span>
                    callkit's callback, the kpe api to pause the call <span class="bold">ios_resumeCallOnLine</span> with the line associated to the call should be invoked.
                </li>
                <li>The callkit's callback <span class="bold">provider(_ provider: CXProvider, didActivate audioSession: AVAudioSession)</span> is invoked
                </li>
                <li>In the callback's body the kpe api <span class="bol">activateAudioSession(isActivate: true)</span>must be invoked</li>
            </ul>
            <p>Below the sequence diagram</p>
            <img src="callkit-resuming_call.png" width="80%"/>
        </div>
    </section>
</body>
</html>
 </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on <span class="timestamp"></span> for KPE User Documentation by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.15.0 </li>
  </ul>
</div>
</body>
</html>
